# Family Calendar - API版 セットアップガイド

このガイドでは、AttendanceAppと同じ仕組みで動作する「API版 Family Calendar」のセットアップ方法を説明します。

## 📋 概要

この構成では、以下のように分離されています：

- **バックエンド**: Google Apps Script (GAS) - データベースとAPIサーバー
- **フロントエンド**: HTML/CSS/JavaScript - ブラウザで動作するカレンダーアプリ

フロントエンドからGASへ`fetch()`でリクエストを送り、データの取得・追加・更新・削除を行います。

---

## 🚀 セットアップ手順

### 1. Google Apps Scriptの設定

#### 1-1. 新しいGASプロジェクトを作成

1. [Google Apps Script](https://script.google.com/) にアクセス
2. 「新しいプロジェクト」をクリック
3. プロジェクト名を「Family Calendar API」などに変更

#### 1-2. コードをコピー

1. デフォルトの`Code.gs`の内容を全て削除
2. `Code_API.gs`の内容を全てコピーして貼り付け
3. 保存（Ctrl+S または ⌘+S）

#### 1-3. デプロイ

1. 右上の「デプロイ」→「新しいデプロイ」をクリック
2. 「種類の選択」で⚙️アイコンをクリック→「ウェブアプリ」を選択
3. 以下のように設定：
   - **説明**: 「Family Calendar API v1」など
   - **次のユーザーとして実行**: 自分
   - **アクセスできるユーザー**: **全員**（重要！）
4. 「デプロイ」をクリック
5. 承認画面が出たら「アクセスを承認」
6. **ウェブアプリのURL**をコピー（後で使います）
   - 例: `https://script.google.com/macros/s/AKfycby.../exec`

---

### 2. フロントエンドの設定

#### 2-1. ファイルの準備

以下のファイルを同じフォルダに配置してください：

- `index_API.html`
- `app_API.js`
- `styles.css`

#### 2-2. ローカルで開く

1. `index_API.html`をブラウザで開く
2. 右上の⚙️（設定）ボタンをクリック
3. 先ほどコピーした**GASのウェブアプリURL**を貼り付け
4. 「保存」をクリック

---

### 3. 動作確認

1. カレンダーが表示されることを確認
2. 日付をクリックして予定を追加してみる
3. スプレッドシートに自動的にデータが保存されているか確認
   - GASエディタの「実行ログ」にスプレッドシートのURLが表示されます

---

## 📱 GitHub Pagesで公開する（オプション）

### 1. GitHubリポジトリを作成

1. [GitHub](https://github.com/)にログイン
2. 「New repository」をクリック
3. リポジトリ名を入力（例: `family-calendar`）
4. 「Public」を選択
5. 「Create repository」をクリック

### 2. ファイルをアップロード

1. 「uploading an existing file」をクリック
2. 以下のファイルをドラッグ&ドロップ：
   - `index_API.html`
   - `app_API.js`
   - `styles.css`
3. 「Commit changes」をクリック

### 3. GitHub Pagesを有効化

1. リポジトリの「Settings」タブをクリック
2. 左メニューの「Pages」をクリック
3. 「Source」で「main」ブランチを選択
4. 「Save」をクリック
5. 数分後、公開URLが表示されます
   - 例: `https://yourusername.github.io/family-calendar/index_API.html`

### 4. スマホからアクセス

1. スマホのブラウザで公開URLにアクセス
2. 設定ボタンからGASのURLを設定
3. ホーム画面に追加すればアプリのように使えます

---

## 🔧 トラブルシューティング

### データが読み込めない

- GASのデプロイ設定で「アクセスできるユーザー」が**全員**になっているか確認
- GASのURLが正しくコピーされているか確認（末尾が`/exec`で終わっているか）
- ブラウザのコンソール（F12）でエラーメッセージを確認

### 予定が保存されない

- GASエディタの「実行ログ」でエラーを確認
- スプレッドシートが正しく作成されているか確認

### 設定が保存されない

- ブラウザのローカルストレージが有効になっているか確認
- プライベートブラウジングモードでは設定が保存されません

---

## 📝 メンテナンス

### コードを更新したとき

1. GASエディタでコードを修正
2. **「デプロイ」→「デプロイを管理」→鉛筆アイコン→「新バージョン」を選択**
3. 「デプロイ」をクリック

※URLは変わらないので、フロントエンド側の設定変更は不要です

---

## 🎉 完了！

これで、どこからでもアクセスできる家族カレンダーが完成しました！
